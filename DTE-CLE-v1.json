{
  "$schema":"http://json-schema.org/draft-07/schema#",
  "title":"Comprobante de Liquidaci√≥n v1",
  "type":"object",
  "properties":{
    "identificacion":{
      "description":"Informacion de identificacion del DTE",
      "type":"object",
      "properties":{
        "version":{
          "type":"integer",
          "description":"Version del esquema del DTE",
          "const":1
        },
        "ambiente":{
          "type":"string",
          "description":"Ambiente de destino: 00 - Pruebas, 01 - Produccion",
          "enum":[
            "00",
            "01"
          ]
        },
        "tipoDte":{
          "type":"string",
          "description":"Tipo de Documento",
          "const":"08"
        },
        "numeroControl":{
          "type":"string",
          "description":"Numero control de DTE, Ej. Formato: DTE-08-12345678-000000000000001",
          "maxLength":31,
          "minLength":31,
          "pattern":"^DTE-08-[A-Z0-9]{8}-[0-9]{15}$"
        },
        "codigoGeneracion":{
          "type":"string",
          "description":"Codigo Generacion",
          "maxLength":36,
          "minLength":36,
          "pattern":"^[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}$"
        },
        "tipoModelo":{
          "type":"number",
          "description":"Modelo de facturacion: 1 - Previo | 2 - Diferido",
          "const":1
        },
        "tipoOperacion":{
          "type":"integer",
          "description":"Tipo de transmision: 1 - Normal, 2 - Contingencia",
          "const":1
        },
        "fecEmi":{
          "type":"string",
          "description":"Fecha de Generacion (formato yyyy-mm-dd)",
          "format":"date"
        },
        "horEmi":{
          "type":"string",
          "description":"Hora de Generacion (formato hh:mi:ss)",
          "pattern":"^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]?$"
        },
        "tipoMoneda":{
          "type":"string",
          "description":"Tipo de moneda en las operaciones",
          "enum":[
            "USD"
          ]
        }
      },
      "additionalProperties":false,
      "required":[
        "version",
        "ambiente",
        "tipoDte",
        "numeroControl",
        "codigoGeneracion",
        "tipoModelo",
        "tipoOperacion",
        "fecEmi",
        "horEmi",
        "tipoMoneda"
      ]
    },
    "emisor":{
      "type":"object",
      "description":"Informacion del comisionista",
      "properties":{
        "nit":{
          "description":"NIT, sin guiones",
          "type":"string",
          "pattern":"^([0-9]{14}|[0-9]{9})$",
          "maxLength":14
        },
        "nrc":{
          "description":"NRC, sin guiones",
          "type":"string",
          "pattern":"^[0-9]{1,8}$",
          "minLength":2,
          "maxLength":8
        },
        "nombre":{
          "type":"string",
          "description":"Nombre/Denominacion/Razon social",
          "maxLength":250,
          "minLength":1
        },
        "codActividad":{
          "type":"string",
          "description":"Codigo actividad economica",
          "pattern":"^[0-9]{2,6}$",
          "maxLength":6,
          "minLength":5
        },
        "descActividad":{
          "type":"string",
          "description":"Descripcion actividad economica",
          "maxLength":150,
          "minLength":5
        },
        "nombreComercial":{
          "description":"Nombre comercial del establecimiento",
          "type":[
            "string",
            "null"
          ],
          "maxLength":150,
          "minLength":5
        },
        "tipoEstablecimiento":{
          "type":"string",
          "description":"Tipo establecimiento donde se emite documento [CAT-009 TIPO DE ESTABLECIMIENTO]",
          "enum":[
            "01",
            "02",
            "04",
            "07",
            "20"
          ]
        },
        "direccion":{
          "type":"object",
          "description":"Direccion de establecimiento",
          "properties":{
            "departamento":{
              "type":"string",
              "description":"Departamento",
              "pattern":"^0[1-9]|1[0-4]$"
            },
            "municipio":{
              "type":"string",
              "description":"Municipio",
              "pattern":"^[0-9]{2}$"
            },
            "complemento":{
              "type":"string",
              "description":"Complemento de direccion",
              "maxLength":200,
              "minLength":1
            }
          },
          "allOf":[
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"01"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-2]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "enum":[
                      "02",
                      "10"
                    ]
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-3]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "enum":[
                      "03",
                      "07"
                    ]
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-6]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"04"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|[12][0-9]|3[0-3]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "enum":[
                      "05",
                      "08"
                    ]
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]|2[0-2]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"06"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"09"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"11"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]|2[0-3]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"12"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]|20$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"13"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]|2[0-6]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"14"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-8]$"
                  }
                }
              }
            }
          ],
          "additionalProperties":false,
          "required":[
            "departamento",
            "municipio",
            "complemento"
          ]
        },
        "telefono":{
          "type":"string",
          "description":"Numero de telefono del emisor",
          "minLength":8,
          "maxLength":30
        },
        "correo":{
          "type":"string",
          "description":"Correo electronico del emisor",
          "format":"email",
          "maxLength":100,
          "minLength":3
        },
        "codEstableMH":{
          "description":"Codigo, Numero o Identificador de establecimiento por MH",
          "type":[
            "string",
            "null"
          ],
          "maxLength":4,
          "minLength":4
        },
        "codEstable":{
          "description":"Codigo de tipo de establecimiento Asignado por la contribuyente",
          "type":[
            "string",
            "null"
          ],
          "minLength":4,
          "maxLength":4
        },
        "codPuntoVentaMH":{
          "description":"Codigo de Identificaci√≥n del  Punto de Venta (Emisor) Asignado por el  MH",
          "type":[
            "string",
            "null"
          ],
          "maxLength":4,
          "minLength":4
        },
        "codPuntoVenta":{
          "description":"Codigo de Identificaci√≥n del  Punto de Venta (Emisor) asignado por la contribuyente",
          "type":[
            "string",
            "null"
          ],
          "maxLength":15,
          "minLength":1
        }
      },
      "additionalProperties":false,
      "required":[
        "nit",
        "nrc",
        "nombre",
        "codActividad",
        "descActividad",
        "nombreComercial",
        "tipoEstablecimiento",
        "direccion",
        "telefono",
        "correo"
      ]
    },
    "receptor":{
      "type":"object",
      "description":"Informacion del demandante",
      "properties":{
        "nit":{
          "type":"string",
          "description":"NIT, sin guiones",
          "pattern":"^([0-9]{14}|[0-9]{9})$"
        },
        "nrc":{
          "type":"string",
          "description":"NRC, sin guiones",
          "pattern":"^[0-9]{1,8}$",
          "minLength":2,
          "maxLength":8
        },
        "nombre":{
          "type":"string",
          "description":"Nombre/Denominacion/Razon social",
          "maxLength":250,
          "minLength":1
        },
        "codActividad":{
          "type":"string",
          "description":"Codigo actividad economica",
          "pattern":"^[0-9]{2,6}$",
          "maxLength":6,
          "minLength":5
        },
        "descActividad":{
          "type":"string",
          "description":"Descripcion actividad economica",
          "maxLength":150,
          "minLength":5
        },
        "nombreComercial":{
          "description":"Nombre comercial del establecimiento",
          "type":[
            "string",
            "null"
          ],
          "maxLength":150,
          "minLength":5
        },
        "direccion":{
          "type":"object",
          "description":"Direccion",
          "properties":{
            "departamento":{
              "type":"string",
              "description":"Departamento",
              "pattern":"^0[1-9]|1[0-4]$"
            },
            "municipio":{
              "type":"string",
              "description":"Municipio",
              "pattern":"^[0-9]{2}$"
            },
            "complemento":{
              "type":"string",
              "description":"Complemento de direccion",
              "maxLength":200,
              "minLength":5
            }
          },
          "allOf":[
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"01"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-2]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "enum":[
                      "02",
                      "10"
                    ]
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-3]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "enum":[
                      "03",
                      "07"
                    ]
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-6]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"04"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|[12][0-9]|3[0-3]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "enum":[
                      "05",
                      "08"
                    ]
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]|2[0-2]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"06"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"09"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"11"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]|2[0-3]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"12"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]|20$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"13"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-9]|2[0-6]$"
                  }
                }
              }
            },
            {
              "if":{
                "properties":{
                  "departamento":{
                    "const":"14"
                  }
                }
              },
              "then":{
                "properties":{
                  "municipio":{
                    "pattern":"^0[1-9]|1[0-8]$"
                  }
                }
              }
            }
          ],
          "additionalProperties":false,
          "required":[
            "departamento",
            "municipio",
            "complemento"
          ]
        },
        "telefono":{
          "type":[
            "string",
            "null"
          ],
          "description":"Numero de telefono del receptor",
          "minLength":8,
          "maxLength":30
        },
        "correo":{
          "type":"string",
          "description":"Correo electronico del receptor",
          "format":"email",
          "maxLength":100
        }
      },
      "additionalProperties":false,
      "required":[
        "nit",
        "nrc",
        "nombre",
        "codActividad",
        "descActividad",
        "direccion",
        "correo"
      ]
    },
    "cuerpoDocumento":{
      "type":"array",
      "description":"Informaci√≥n del Cuerpo del documento",
      "items":{
        "type":"object",
        "properties":{
          "numItem":{
            "type":"integer",
            "description":"Numero correlativo de item",
            "minimum":1,
            "maximum":500
          },
          "tipoDte":{
            "type":"string",
            "description":"Tipo Item",
            "enum":[
              "01",
              "03",
              "05",
              "06",
              "11"
            ]
          },
          "tipoGeneracion":{
            "type":"integer",
            "description":"Tipo Generacion 1. fisico 2. Electronico",
            "enum":[
              1,
              2
            ]
          },
          "numeroDocumento":{
            "description":"Codigo Generacion/Correlativo de seccion Documento Relacionado",
            "type": "string",
            "minLength":1,
            "maxLength":36
          },
          "fechaGeneracion":{
            "type":"string",
            "description":"Fecha de Generacion (formato yyyy-mm-dd)",
            "format":"date"
          },
          "ventaNoSuj":{
            "type":"number",
            "description":"Venta no sujeta",
            "exclusiveMaximum":100000000000,
            "exclusiveMinimum" : -100000000000,
            "multipleOf":1e-08
          },
          "ventaExenta":{
            "type":"number",
            "description":"Venta no Exenta",
            "exclusiveMaximum":100000000000,
            "exclusiveMinimum" : -100000000000,
            "multipleOf":1e-08
          },
          "ventaGravada":{
            "type":"number",
            "description":"Venta Gravada",
            "exclusiveMaximum":100000000000,
            "exclusiveMinimum" : -100000000000,
            "multipleOf":1e-08
          },
          "exportaciones":{
            "type":"number",
            "description":"Venta Gravada",
            "exclusiveMaximum":100000000000,
            "exclusiveMinimum" : -100000000000,
            "multipleOf":1e-08
          },
          "tributos":{
            "description":"Codigos de tributos a aplicar [CAT-015 Tributos]",
            "type":[
              "array",
              "null"
            ],
            "items":{
              "type":"string",
              "maxLength":2,
              "minLength":2,
              "enum":[
                null,
                "20",
                "C3",
                "59",
                "71",
                "D1",
                "C8",
                "D5",
                "D4"
              ]
            },
            "uniqueItems":true
          },
          "ivaItem":{
            "type":"number",
            "description":"Iva por item",
            "exclusiveMaximum":100000000000,
            "exclusiveMinimum" : -100000000000,
            "multipleOf":1e-08
          },
          "obsItem":{
            "type":"string",
            "description":"Observaciones por item",
            "maxLength":3000,
            "minLength":3
          }
        },
        "allOf":[
          {
            "if":{
              "properties":{
                "ventaGravada":{
                  "exclusiveMinimum":0
                }
              }
            },
            "then":{
              "properties":{
                "tributos":{
                  "items":{
                    "enum":[
                      "20"
                    ]
                  }
                }
              }
            }
          },
          {
            "if":{
              "properties":{
                "ventaNoSuj":{
                  "exclusiveMaximum":0
                }
              }
            },
            "then":{
              "properties":{
                "tributos":{
                  "type":"null"
                }
              }
            }
          },
          {
            "if":{
              "properties":{
                "ventaExenta":{
                  "exclusiveMaximum":0
                }
              }
            },
            "then":{
              "properties":{
                "tributos":{
                  "type":"null"
                }
              }
            }
          },
          {
            "if":{
              "properties":{
                "tipoGeneracion":{
                  "const":1
                }
              }
            },
            "then":{
              "properties":{
                "numeroDocumento":{
                  "type":"string",
                  "pattern":"^[A-Z]|[0-9]$",
                  "minLength":1,
                  "maxLength":20
                }
              }
            },
            "else":{
              "properties":{
                "numeroDocumento":{
                  "pattern":"^[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}$"
                }
              }
            }
          }
        ],
        "additionalProperties":false,
        "required":[
          "numItem",
          "tipoDte",
          "tipoGeneracion",
          "numeroDocumento",
          "fechaGeneracion",
          "ventaNoSuj",
          "ventaExenta",
          "ventaGravada",
          "tributos"
        ]
      },
      "minItems":1,
      "maxItems":500
    },
    "resumen":{
      "type":"object",
      "description":"Informacion de documentos relacionados",
      "properties":{
        "totalNoSuj":{
          "type":"number",
          "description":"Total de operaciones No Sujetas",
          "exclusiveMaximum":100000000000,
          "exclusiveMinimum" : -100000000000,
          "multipleOf":0.01
        },
        "totalExenta":{
          "type":"number",
          "description":"Total de operaciones Exentas",
          "exclusiveMaximum":100000000000,
          "exclusiveMinimum" : -100000000000,
          "multipleOf":0.01
        },
        "totalGravada":{
          "type":"number",
          "description":"Total de operaciones Gravadas",
          "exclusiveMaximum":100000000000,
          "exclusiveMinimum" : -100000000000,
          "multipleOf":0.01
        },
        "totalExportacion":{
          "type":"number",
          "description":"Total de operaciones Gravadas",
          "exclusiveMaximum":100000000000,
          "exclusiveMinimum" : -100000000000,
          "multipleOf":0.01
        },
        "subTotalVentas":{
          "type":"number",
          "description":"Sumatoria de las operaciones de ventas (totalNoSuj + totalExenta + totalGravada)",
          "exclusiveMaximum":100000000000,
          "exclusiveMinimum" : -100000000000,
          "multipleOf":0.01
        },
        "tributos":{
          "type":[
            "array",
            "null"
          ],
          "description":"Detalle de tributos",
          "items":{
            "type":"object",
            "properties":{
              "codigo":{
                "description":"Codigo de tributo [CAT-015 Tributos]",
                "type":"string",
                "enum":[
                  null,
                  "20",
                  "C3",
                  "59",
                  "71",
                  "D1",
                  "C8",
                  "D5",
                  "D4"
                ],
                "minLength":2,
                "maxLength":2
              },
              "descripcion":{
                "description":"Descripcion de tributo [CAT-015 Tributos]",
                "type":"string",
                "minLength":2,
                "maxLength":300
              },
              "valor":{
                "description":"Valor",
                "type":"number",
                "exclusiveMaximum":100000000000,
                "exclusiveMinimum" : -100000000000,
                "multipleOf":0.01
              }
            }
          }
        },
        "montoTotalOperacion":{
          "type":"number",
          "description":"Monto Total de Operacion (subTotal  + Sumatoria[tributos.valor]).",
          "exclusiveMaximum":100000000000,
          "exclusiveMinimum" : -100000000000,
          "multipleOf":0.01
        },
        "ivaPerci":{
          "type":"number",
          "description":"Total de IVA Percibido",
          "exclusiveMaximum":100000000000,
          "exclusiveMinimum" : -100000000000,
          "multipleOf":0.01
        },
        "total":{
          "type":"number",
          "description":"Total a pagar (totalOperacion + ivaPerci1 - ivaRete1 - reteRenta +/- totalNoGravado).",
          "exclusiveMaximum":100000000000,
          "exclusiveMinimum" : -100000000000,
          "multipleOf":0.01
        },
        "totalLetras":{
          "type":"string",
          "description":"Total a pagar en letras",
          "maxLength":200
        },
        "condicionOperacion":{
          "type":"number",
          "description":"Condicion de la Operacion: [CAT-016 Condicion de la Operacion]",
          "enum":[
            1,
            2,
            3
          ]
        }
      },
      "allOf":[
        {
          "if":{
            "properties":{
              "total":{
                "const":0
              }
            }
          },
          "then":{
            "properties":{
              "condicionOperacion":{
                "enum":[
                  1
                ]
              }
            }
          }
        }
      ],
      "additionalProperties":false,
      "required":[
        "totalNoSuj",
        "totalExenta",
        "totalGravada",
        "totalExportacion",
        "subTotalVentas",
        "tributos",
        "montoTotalOperacion",
        "ivaPerci",
        "total",
        "totalLetras",
        "condicionOperacion"
      ]
    },
    "extension":{
      "type":"object",
      "description":"Informacion de extencion de documento",
      "properties":{
        "nombEntrega":{
          "description":"Nombre de la persona que entrega DTE",
          "type":[
            "string",
            "null"
          ],
          "maxLength":100,
          "minLength":5
        },
        "docuEntrega":{
          "description":"Documento de la persona que entrega DTE",
          "type":[
            "string",
            "null"
          ],
          "maxLength":25,
          "minLength":5
        },
        "nombRecibe":{
          "description":"Nombre de la persona que recibe DTE",
          "type":[
            "string",
            "null"
          ],
          "maxLength":100,
          "minLength":5
        },
        "docuRecibe":{
          "description":"Documento de la persona que recibe DTE",
          "type":[
            "string",
            "null"
          ],
          "maxLength":25,
          "minLength":5
        },
        "observaciones":{
          "description":"Observaciones adicionales",
          "type":[
            "string",
            "null"
          ],
          "maxLength":3000
        }
      },
      "additionalProperties":false,
      "required":[
        "nombEntrega",
        "docuEntrega",
        "nombRecibe",
        "docuRecibe"
      ]
    },
    "apendice":{
      "description":"Para informacion propia del emisor (donde aplique)",
      "type":[
        "array",
        "null"
      ],
      "items":{
        "type":"object",
        "properties":{
          "campo":{
            "type":"string",
            "description":"Nombre del campo",
            "maxLength":25
          },
          "etiqueta":{
            "type":"string",
            "description":"Etiqueta (a mostrar en representacion grafica)",
            "maxLength":50
          },
          "valor":{
            "type":"string",
            "description":"Valor del campo",
            "maxLength":150
          }
        },
        "additionalProperties":false,
        "required":[
          "campo",
          "etiqueta",
          "valor"
        ]
      },
      "minItems":1,
      "maxItems":10
    }
  },
  "allOf":[
    {
      "if":{
        "properties":{
          "resumen":{
            "properties":{
              "montoTotalOperacion":{
                "minimum":20000.0
              }
            }
          }
        }
      },
      "then":{
        "properties":{
          "extension":{
            "properties":{
              "nombEntrega":{
                "type":"string"
              },
              "docuEntrega":{
                "type":"string"
              },
              "nombRecibe":{
                "type":"string"
              },
              "docuRecibe":{
                "type":"string"
              }
            }
          }
        }
      }
    }
  ],
  "additionalProperties":false,
  "required":[
    "identificacion",
    "emisor",
    "receptor",
    "cuerpoDocumento",
    "resumen"
  ]
}